{"is_source_file": true, "format": "TypeScript", "description": "This file defines an Angular service named GameService that manages the state, rendering, input handling, and game logic for a 2D circus-themed jump challenge game. It includes interfaces for game entities, obstacle initialization, game state updates, and rendering routines with custom drawing functions for game characters and obstacles.", "external_files": ["angular/core"], "external_methods": ["HTMLCanvasElement", "CanvasRenderingContext2D"], "published": ["GameService"], "classes": [{"name": "GameService", "description": "An Angular Injectable service that encapsulates game state, rendering, and input handling for a circus jump game."}], "methods": [{"name": "attachCanvas", "description": "Attaches an HTML canvas element, rendering context, and parent reference to the service, and updates canvas size accordingly."}, {"name": "updateCanvasSize", "description": "Adjusts the canvas size based on the current window dimensions, maintaining maximum width and height constraints."}, {"name": "init", "description": "Resets game state to default and initializes obstacles."}, {"name": "defaultState", "description": "Returns the default initial game state, including high score retrieval from local storage."}, {"name": "initObstacles", "description": "Generates a series of obstacles with randomized positions and behaviors for the game level."}, {"name": "update", "description": "Performs a game tick: updating positions, handling controls, collisions, scoring, and level completion logic."}, {"name": "aabb", "description": "Axis-Aligned Bounding Box collision detection between player and obstacle rectangles."}, {"name": "render", "description": "Renders the game scene onto the attached canvas, including background, obstacles, goal, and player."}, {"name": "drawAcrobat", "description": "Draws the player's character with basic shapes, indicating jumping and direction."}, {"name": "drawLion", "description": "Draws a lion obstacle character."}, {"name": "drawFireRing", "description": "Draws a fire hoop obstacle, with optional animation."}, {"name": "onKeyDown", "description": "Handles key press events to control movement and jumping."}, {"name": "onKeyUp", "description": "Handles key release events to control movement and jumping."}, {"name": "onTouchStart", "description": "Handles touch start events for mobile controls."}, {"name": "onTouchMove", "description": "Handles touch move events for mobile controls, updating movement based on drag distance."}, {"name": "onTouchEnd", "description": "Resets control states when touch ends."}], "search-terms": ["GameService", "Obstacle", "player", "canvas", "render", "collision", "jump", "circus", "pixel-art"], "state": 2, "file_id": 27, "knowledge_revision": 91, "git_revision": "b51a96b23d9d83039bc60a6669c5dd74ee4095db", "revision_history": [{"56": ""}, {"72": ""}, {"79": ""}, {"84": ""}, {"87": ""}, {"91": "b51a96b23d9d83039bc60a6669c5dd74ee4095db"}], "ctags": [{"_type": "tag", "name": "GameService", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^export class GameService {$/", "language": "TypeScript", "kind": "class"}, {"_type": "tag", "name": "GameState", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^export interface GameState {$/", "language": "TypeScript", "kind": "interface"}, {"_type": "tag", "name": "Obstacle", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^export interface Obstacle {$/", "language": "TypeScript", "kind": "interface"}, {"_type": "tag", "name": "Vec", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^export interface Vec {$/", "language": "TypeScript", "kind": "interface"}, {"_type": "tag", "name": "active", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^  active: boolean;$/", "language": "TypeScript", "kind": "property", "scope": "Obstacle", "scopeKind": "interface"}, {"_type": "tag", "name": "ctx", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^    const ctx = this.ctx, st = this.state;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "dx", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^    let dx = e.touches[0].clientX - this.dragX;$/", "language": "TypeScript", "kind": "variable"}, {"_type": "tag", "name": "dx", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^  dx: number;$/", "language": "TypeScript", "kind": "property", "scope": "Obstacle", "scopeKind": "interface"}, {"_type": "tag", "name": "dy", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^    let dy = e.touches[0].clientY - this.dragY;$/", "language": "TypeScript", "kind": "variable"}, {"_type": "tag", "name": "fx", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^    let fx = st.winLine-st.worldOffset;$/", "language": "TypeScript", "kind": "variable"}, {"_type": "tag", "name": "grad", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^    let grad = ctx.createLinearGradient(0, 0, 0, this.canvasH);$/", "language": "TypeScript", "kind": "variable"}, {"_type": "tag", "name": "groundY", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^  groundY: number;$/", "language": "TypeScript", "kind": "property", "scope": "GameState", "scopeKind": "interface"}, {"_type": "tag", "name": "height", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^  height: number;$/", "language": "TypeScript", "kind": "property", "scope": "Obstacle", "scopeKind": "interface"}, {"_type": "tag", "name": "highScore", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^    let highScore = 0;$/", "language": "TypeScript", "kind": "variable"}, {"_type": "tag", "name": "highScore", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^  highScore: number;$/", "language": "TypeScript", "kind": "property", "scope": "GameState", "scopeKind": "interface"}, {"_type": "tag", "name": "i", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^    for (let i = 0; i < 14; ++i) {$/", "language": "TypeScript", "kind": "variable"}, {"_type": "tag", "name": "i", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^    for (let i = 0; i < 7; ++i) {$/", "language": "TypeScript", "kind": "variable"}, {"_type": "tag", "name": "i", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^    for(let i=0;i<8;++i) {$/", "language": "TypeScript", "kind": "variable"}, {"_type": "tag", "name": "isGameOver", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^  isGameOver: boolean;$/", "language": "TypeScript", "kind": "property", "scope": "GameState", "scopeKind": "interface"}, {"_type": "tag", "name": "isLevelComplete", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^  isLevelComplete: boolean;$/", "language": "TypeScript", "kind": "property", "scope": "GameState", "scopeKind": "interface"}, {"_type": "tag", "name": "kind", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^  kind: 'fire' | 'animal';$/", "language": "TypeScript", "kind": "property", "scope": "Obstacle", "scopeKind": "interface"}, {"_type": "tag", "name": "maxH", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^      const maxH = Math.min(globalThis.innerHeight - 120, 240);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "maxW", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^      const maxW = Math.min(globalThis.innerWidth - 24, 430);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "obs", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^    const obs: Obstacle[] = [];$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "obstacles", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^  obstacles: Obstacle[];$/", "language": "TypeScript", "kind": "property", "scope": "GameState", "scopeKind": "interface"}, {"_type": "tag", "name": "ox", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^      const ox = o.x - st.worldOffset;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "player", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^  player: {$/", "language": "TypeScript", "kind": "property", "scope": "GameState", "scopeKind": "interface"}, {"_type": "tag", "name": "pos", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^    let pos = 125;$/", "language": "TypeScript", "kind": "variable"}, {"_type": "tag", "name": "raw", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^      const raw = globalThis.localStorage.getItem('circus_highscore');$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "rotation", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^      let rotation = ((Math.PI*2)\\/7)*i;$/", "language": "TypeScript", "kind": "variable"}, {"_type": "tag", "name": "score", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^  score: number;$/", "language": "TypeScript", "kind": "property", "scope": "GameState", "scopeKind": "interface"}, {"_type": "tag", "name": "sprite", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^  sprite: string;$/", "language": "TypeScript", "kind": "property", "scope": "Obstacle", "scopeKind": "interface"}, {"_type": "tag", "name": "st", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^      const ox = o.x - st.worldOffset;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "st", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^    const ctx = this.ctx, st = this.state;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "st", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^    const st = this.state;$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "st", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^    let fx = st.winLine-st.worldOffset;$/", "language": "TypeScript", "kind": "variable"}, {"_type": "tag", "name": "state", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^  public state: GameState;$/", "language": "TypeScript", "kind": "property", "scope": "GameService", "scopeKind": "class"}, {"_type": "tag", "name": "tick", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^  tick: number;$/", "language": "TypeScript", "kind": "property", "scope": "GameState", "scopeKind": "interface"}, {"_type": "tag", "name": "width", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^  width: number;$/", "language": "TypeScript", "kind": "property", "scope": "Obstacle", "scopeKind": "interface"}, {"_type": "tag", "name": "winLine", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^  winLine: number;$/", "language": "TypeScript", "kind": "property", "scope": "GameState", "scopeKind": "interface"}, {"_type": "tag", "name": "worldOffset", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^  worldOffset: number;$/", "language": "TypeScript", "kind": "property", "scope": "GameState", "scopeKind": "interface"}, {"_type": "tag", "name": "x", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^      let x = 35+i*62-(st.worldOffset%62);$/", "language": "TypeScript", "kind": "variable"}, {"_type": "tag", "name": "x", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^  x: number;    \\/\\/ for scrolling$/", "language": "TypeScript", "kind": "property", "scope": "Obstacle", "scopeKind": "interface"}, {"_type": "tag", "name": "x", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^  x: number;$/", "language": "TypeScript", "kind": "property", "scope": "Vec", "scopeKind": "interface"}, {"_type": "tag", "name": "y", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^  y: number;$/", "language": "TypeScript", "kind": "property", "scope": "Obstacle", "scopeKind": "interface"}, {"_type": "tag", "name": "y", "path": "/home/kavia/workspace/code-generation/circus-jump-challenge-dd6955cc/game_frontend/src/app/services/game.service.ts", "pattern": "/^  y: number;$/", "language": "TypeScript", "kind": "property", "scope": "Vec", "scopeKind": "interface"}], "hash": "75d02bec18a6760c28be935d8d6225ec", "format-version": 4, "code-base-name": "game_frontend", "filename": "game_frontend/src/app/services/game.service.ts", "fields": [{"name": "export interface GameState {", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "export interface Obstacle {", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "export interface Vec {", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "active: boolean;", "scope": "Obstacle", "scopeKind": "interface", "description": "unavailable"}, {"name": "let dx = e.touches[0].clientX - this.dragX;", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "dx: number;", "scope": "Obstacle", "scopeKind": "interface", "description": "unavailable"}, {"name": "let dy = e.touches[0].clientY - this.dragY;", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "let fx = st.winLine-st.worldOffset;", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "let grad = ctx.createLinearGradient(0, 0, 0, this.canvasH);", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "groundY: number;", "scope": "GameState", "scopeKind": "interface", "description": "unavailable"}, {"name": "height: number;", "scope": "Obstacle", "scopeKind": "interface", "description": "unavailable"}, {"name": "let highScore = 0;", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "highScore: number;", "scope": "GameState", "scopeKind": "interface", "description": "unavailable"}, {"name": "for (let i = 0; i < 14; ++i) {", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "for (let i = 0; i < 7; ++i) {", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "for(let i=0;i<8;++i) {", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "isGameOver: boolean;", "scope": "GameState", "scopeKind": "interface", "description": "unavailable"}, {"name": "isLevelComplete: boolean;", "scope": "GameState", "scopeKind": "interface", "description": "unavailable"}, {"name": "kind: 'fire' | 'animal';", "scope": "Obstacle", "scopeKind": "interface", "description": "unavailable"}, {"name": "obstacles: Obstacle[];", "scope": "GameState", "scopeKind": "interface", "description": "unavailable"}, {"name": "player: {", "scope": "GameState", "scopeKind": "interface", "description": "unavailable"}, {"name": "let pos = 125;", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "let rotation = ((Math.PI*2)\\/7)*i;", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "score: number;", "scope": "GameState", "scopeKind": "interface", "description": "unavailable"}, {"name": "sprite: string;", "scope": "Obstacle", "scopeKind": "interface", "description": "unavailable"}, {"name": "public state: GameState;", "scope": "GameService", "scopeKind": "class", "description": "unavailable"}, {"name": "tick: number;", "scope": "GameState", "scopeKind": "interface", "description": "unavailable"}, {"name": "width: number;", "scope": "Obstacle", "scopeKind": "interface", "description": "unavailable"}, {"name": "winLine: number;", "scope": "GameState", "scopeKind": "interface", "description": "unavailable"}, {"name": "worldOffset: number;", "scope": "GameState", "scopeKind": "interface", "description": "unavailable"}, {"name": "let x = 35+i*62-(st.worldOffset%62);", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "x: number;    \\/\\/ for scrolling", "scope": "Obstacle", "scopeKind": "interface", "description": "unavailable"}, {"name": "x: number;", "scope": "Vec", "scopeKind": "interface", "description": "unavailable"}, {"name": "y: number;", "scope": "Obstacle", "scopeKind": "interface", "description": "unavailable"}]}